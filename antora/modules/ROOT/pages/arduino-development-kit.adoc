= Arduino development kit

This documents presents an overview of the Arduino development kit provided
by Hyper. The development kit includes an Arduino development board with an
example source code for sensor integration and a
xref:hyper-link-wifi.adoc[] device that can be connected to the Arduino
development board to publish the data to the cloud deployment and allow local
monitoring during development.

== Components

The development kit includes the following components and parts:

* *Arduino board* - serves as an example external device programmed by users;
* *Hyper Link WiFi device* - a device that provides WiFi connectivity and can be used during development to monitor the values recorded by the Arduino board;
* *Hyper Link Thread device* - a device that provides https://en.wikipedia.org/wiki/Thread_(network_protocol)[Thread] connectivity and can be used in a production environment to connect the Arduino board to a Thread mesh network.
* *Bidirectional I2C isolator* - an I2C isolator with two STEMMA QT/Qwiic connectors that should be used to connect the Hyper Link devices to the Arduino board.

NOTE: The Hyper Link Thread device requires a Thread-compatible gateway device that creates the mesh network and forwards the data to Hyper's cloud environment. The gateway device is not included in the development kit and is only required for production deployments.

=== Arduino board and I2C isolator

The Arduino board included in the kit is meant to be a reference example of an external device to be integrated with the Hyper platform. The Arduino board is pre-configured as an external Hyper device with a number of sensor attributes.

The source code of the the Arduino project is available at https://github.com/hyper-systems/hyper-link-arduino.

You can use this device to test the integration, program it in a way that suits your use case to collect any sensor measurements or even trigger execution of commands.

.Arduino board with an I2C isolator and STEMMA QT/Qwiic connectors
image::hyper-arduino-board-and-i2c-isolator.jpeg[Arduino board and I2C isolator,800]


=== Hyper Link WiFi device

Use this device to connect the Arduino board provided in the kit to establish a WiFi connection and start collecting sensor readings. The collected data can be viewed locally in a web UI provided by the Hyper Link WiFi device itself and, in addition to that, will be published to a cloud deployment associated with your account.

.Hyper Link WiFi board (ESP32, SparkFun Thing Plus)
image::hyper-link-wifi-board.jpg[ESP32,400]

For more information see the xref:hyper-link-wifi.adoc[] device page.


=== Hyper Link Thread device

Use this device to connect the Arduino board provided in the kit to establish a Thread connection with a Thread gateway device (such as Hyper Edge). Similar to the Hyper Link WiFi board, this device provides an I2C STEMMA QT/Qwiic connector.

Both Hyper Link Thread and Hyper Link WiFi devices implement the same data collection protocol allowing for seamless transition from WiFi to Thread connectivity.

.Hyper Link Thread board
image::hyper-link-thread-board.png[Hyper Link Thread,800]

NOTE: The Hyper Link Thread device was originally called "Hyper Axon". Some development kits might included a board with the "Hyper Axon Board" label.

For more information see the xref:hyper-link-thread.adoc[] device page.

== Setup your board

Follow the official instructions for configuring the Arduino IDE for
your board.


== Integrate the Arduino library

The Arduino library code for your device type will include an example
`main` file that demonstrates how to initialise and start using your
device type.

You start making changes to the code to add any modifications necessary
for your project.

The following sections must be present in your code to get a working
integration:

=== 1. Include the library code

[source,cpp]
----
// Include the generated support code for working with your device over
// I2C-slave interface. Replacce "XXX" with your unique device type identifier.
#include "HyperDeviceXXXI2CSlave.V1.h"
----

=== 2. Define the global device variable

[source,cpp]
----
// Define a variable for your Hyper device in the global scope to make it easy
// for your to access the device anywhere in your code.
HyperDeviceXXXI2CSlave hyperDevice;
----

=== 3. Setup the device identifier and bind write attributes

[source,cpp]
----
void setup() {
  // All devices must have a unique identifer composed of 6 hex characters. 
  // If possible use your boards MAC address or find an equivalent unique identifer.
  const uint8_t deviceId[6] = {0xFF, 0xFF, 0xFF, 0x00, 0x00, 0x01};
  hyperDevice.begin(deviceId);

  // Bind write attributes.
  // Write attributes can be used to push data to your device from the server.
  // This section can be used to assign custom function handlers for every
  // write attribute. The function callback can perform any changes to the
  // device necessary to react to the attribute change.
  hyperDevice.bindMyAttribute1(onMyAttribute1Update);
}
----

=== 4. Record read attribute changes

[source,cpp]
----
void loop() {
  int adcVal = analogRead(A0);

  // Record the values for your read attributes.
  hyperDevice.setMyAttribute1(adcVal); <.>

  delay(1000);
}
----
<.> The included header has setter functions for all the attributes of your device.

Having completed these code changes your project is ready to start
publishing read attribute values and processing write attribute updates
from the server.

You can always refer to the ZIP archieve for a complete example of the
integration.

== Test your setup

Once you have completed the software integration and uploaded the code
to your board, you can start testing the setup by connecting your board
to the Hyper Link device.

To connect the Hyper Link device you need to use a I2C-compatible port.
Our boards come with a I2C 3.3V QWIIC connector.

Hyper provides multiple Link devices for both development and production
scenarios.

During production you can use a Hypr Link device that supports a network
protocol most suitable for your deployment such as Thread, Bluetooth,
LoRa or WiFi.

For development we recommend using our Hyper Link WiFi device that makes
is easy to visualise the data coming in and out of your board. You can
work with it offline or online.